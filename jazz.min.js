function JazzHands(){Jazz.ui,this.getFingersMap=function(a){return Jazz.lastFrame.pointablesMap?a?Jazz.lastFrame.pointablesMap[a]:Jazz.lastFrame.pointablesMap:void 0},this.getFinger=function(a){return this.getFingersMap(a)},this.getRadiusForFinger=function(a){return Math.min(600/Math.abs(a[2]),20)*Jazz.CIRCLE_RADIUS},this.getYForCoords=function(a){return-a[1]-120-this.getRadiusForFinger(a)/2},this.getXForCoords=function(a){return parseInt(a[0]-900-this.getRadiusForFinger(a)/2)},this.getCapturedDigits=function(){return Jazz.frameDigitCount},this.isNewFingerCount=function(){return 0===this.getCapturedDigits()||Jazz.lastDigitsFound!==this.getCapturedDigits()},this.isHoldingFinger=function(){return this.getCapturedDigits()>0&&1==this.isNewFingerCount()},this.isValidFinger=function(){return this.getCapturedDigits()>0&&this.getCapturedDigits()<=Jazz.LAST_VALID_FINGER},this.isHoldingValidFinger=function(){return(this.isHoldingFinger()&&this.isValidFinger())===!0},this.hasDetectedHand=function(){return Jazz.handsArray.length>0},this.isNewHandMotion=function(){return Jazz.handNavigation!==Jazz.ui.getDetectedNav()},this.getFirstFingerPos=function(){for(var a in this.getFingersMap())return this.getFingersMap(a).tipPosition},this.getHandPos=function(a){return Jazz.handsArray.length<=0?void 0:0===a?this.getXForCoords(Jazz.handsArray[0].palmPosition):this.getYForCoords(Jazz.handsArray[0].palmPosition)},this.getHandPosX=function(){return this.getHandPos(0)},this.getHandPosY=function(){return this.getHandPos(1)},this.palm=function(a){if(0!==Jazz.handsArray.length){var b=Jazz.handsArray[0];return"horizontal"===a?b.palmPosition[0]:"vertical"===a?b.palmPosition[1]:"depth"===a?b.palmPosition[2]:void 0}},this.isNewHand=function(){return Jazz.lastHandId==Jazz.handsArray[0].id}}function JazzEvents(){var a=Jazz.ui,b=Jazz.hands,c=new JazzEventHelper;this.loop=function(d){Jazz.lastFrame=d,Jazz.handsArray=d.hands,Jazz.handsArray.length>0?a.showCanvas():(a.hideCanvas(),Jazz.handNavigation=null),Jazz.frameDigitCount=d.pointables.length,a.updateCanvas(),Jazz.frameDigitCount>=Jazz.LAST_VALID_FINGER?Jazz.simpleMode=!0:(Jazz.simpleMode=!1,Jazz.disableFingers===!1&&c.handleFingers()),Jazz.isGrabbing===!1&&b.isHoldingValidFinger()===!1&&c.handleNavigation(),c.handleGestureEvents(),c.handleProgressNav(),c.handleGrabRelease(),Jazz.event.frames(Jazz.lastFrame)},this.getFingersMap=function(a){return Jazz.lastFrame.pointablesMap?a?Jazz.lastFrame.pointablesMap[a]:Jazz.lastFrame.pointablesMap:void 0}}function JazzConfig(){this.configureFromOptions=function(a){Jazz.fillStyle="black",Jazz.LAST_VALID_FINGER=1,this.setupImages(),a&&(a.fillStyle&&(Jazz.arrowColor=Jazz.fillStyle=a.fillStyle),a.waitTimer&&(Jazz.WAIT_FINGER_MS=a.waitTimer),a.fingersText&&(Jazz.fingersText=Jazz.fingersText.concat(a.fingersText),Jazz.LAST_VALID_FINGER=a.fingersText.length+1),Jazz.simpleMode=Jazz.LAST_VALID_FINGER>1?!1:!0,void 0!=a.disableTimer&&a.disableTimer!=Jazz.disableTimer&&(Jazz.disableTimer=a.disableTimer),void 0!=a.disableZoom&&a.disableZoom!=Jazz.disableZoom&&(Jazz.disableZoom=a.disableZoom),void 0!=a.disableHelper&&a.disableHelper!=Jazz.disableHelper&&(Jazz.disableHelper=a.disableHelper),void 0!=a.disableFingers&&a.disableFingers!=Jazz.disableFingers&&(Jazz.disableFingers=a.disableFingers),a.opacity&&(Jazz.opacity=a.opacity))},this.setupImages=function(){var a=$("script[src*=jazz]").attr("src");a=a.replace("jazz.min.js","");var b=a.substring(0,a.indexOf("jazz")),c=Jazz.filePath=b+"images/";Jazz.upArrow=new Image,Jazz.upArrow.src=c+Jazz.arrowColor+"_up_arrow.png",Jazz.downArrow=new Image,Jazz.downArrow.src=c+Jazz.arrowColor+"_down_arrow.png",Jazz.rightArrow=new Image,Jazz.rightArrow.src=c+Jazz.arrowColor+"_right_arrow.png",Jazz.leftArrow=new Image,Jazz.leftArrow.src=c+Jazz.arrowColor+"_left_arrow.png",Jazz.zoomIn=new Image,Jazz.zoomIn.src=c+Jazz.arrowColor+"_zoom_in.png",Jazz.zoomOut=new Image,Jazz.zoomOut.src=c+Jazz.arrowColor+"_zoom_out.png",this.setupHelperImages()},this.setupHelperImages=function(){var a=$("script[src*=jazz]").attr("src");a=a.replace("jazz.min.js","");var b=a.substring(0,a.indexOf("jazz")),c=Jazz.filePath=b+"images/";Jazz.upHelperArrow=new Image,Jazz.upHelperArrow.src=c+"gray_up_arrow.png",Jazz.downHelperArrow=new Image,Jazz.downHelperArrow.src=c+"gray_down_arrow.png",Jazz.rightHelperArrow=new Image,Jazz.rightHelperArrow.src=c+"gray_right_arrow.png",Jazz.leftHelperArrow=new Image,Jazz.leftHelperArrow.src=c+"gray_left_arrow.png"},this.threshold=function(a){return"zoomIn"===a?-10:"zoomOut"===a?120:"up"===a?225:"down"===a?90:"left"===a?-80:"right"===a?80:void 0},Jazz.event={finger:function(){},navigation:function(){},gestures:function(){},frames:function(){},progress:function(){},grab:function(){},release:function(){}},Jazz.lastDigitsFound=0,Jazz.handNavigation="",Jazz.WAIT_FINGER_MS=700,Jazz.LAST_VALID_FINGER=2,Jazz.WAIT_INTERVAL_TIMER=40,Jazz.CIRCLE_RADIUS=1.6,Jazz.opacity=.45,Jazz.fingersText=[],Jazz.arrowColor="black",Jazz.incr=0,Jazz.lastFrame={},Jazz.handsArray=[],Jazz.timerPercentage=0,Jazz.simpleMode=!0,Jazz.disableZoom=!1,Jazz.disableHelper=!1,Jazz.disableTimer=!1,Jazz.disableFingers=!1,Jazz.showUI=!0,Jazz.isGrabbing=!1,Jazz.isReady=!1,Jazz.FIRST=0,Jazz.SECOND=1,Jazz.THIRD=2,Jazz.FOURTH=3}function JazzEventHelper(){var a=Jazz.hands,b=Jazz.config;this.handleNavigation=function(){return a.getCapturedDigits()<Jazz.LAST_VALID_FINGER?!1:(a.hasDetectedHand()===!0&&(a.isNewHandMotion()===!0&&(this.clearTimeoutForNav(),this.setTimeoutForNav()),Jazz.ui.getDetectedNav()===!1&&(this.clearTimeoutForNav(),Jazz.handNavigation=null),Jazz.handNavigation=Jazz.ui.getDetectedNav()),void 0)},this.handleGrabRelease=function(){return 0===Jazz.handsArray.length?(Jazz.isGrabbing===!0&&(Jazz.isGrabbing=!1,Jazz.event.release()),void 0):(a.getCapturedDigits()<=1?(Jazz.isGrabbing===!1&&Jazz.event.grab(),Jazz.isGrabbing=!0):1==Jazz.isGrabbing&&(Jazz.isGrabbing=!1,Jazz.event.release()),void 0)},this.handleProgressNav=function(){if(0!==Jazz.handsArray.length){var d=b.threshold("up")-b.threshold("down"),e=(a.palm("vertical")-b.threshold("down"))/d;e>1&&(e=1),0>e&&(e=0);var f=1-e,g=b.threshold("right")-b.threshold("left"),h=(a.palm("horizontal")-b.threshold("left"))/g;h>1&&(h=1),0>h&&(h=0);var i=1-h,j=b.threshold("zoomIn")-b.threshold("zoomOut"),k=(a.palm("depth")-b.threshold("zoomOut"))/j;k>1&&(k=1),0>k&&(k=0);var l=1-k,m={up:parseInt(100*e),down:parseInt(100*f),right:parseInt(100*h),left:parseInt(100*i),zoomIn:parseInt(100*k),zoomOut:parseInt(100*l)};return Jazz.event.progress(m),m}},this.handleFingers=function(){a.isNewFingerCount()&&this.clearTimeoutForDigits(),a.isHoldingValidFinger()&&this.setTimeoutForDigits(),Jazz.lastDigitsFound=a.getCapturedDigits()},this.handleGestureEvents=function(){var b=Jazz.lastFrame.gestures;if(a.getCapturedDigits()>0&&b.length>0)for(var c=0;c<b.length;c++){var d=b[c];Jazz.lastGesture=d}else if(Jazz.lastGesture){var d=Jazz.lastGesture,e=!0;"circle"===d.type&&d.radius<100&&(e=!1),e===!0&&Jazz.event.gestures(Jazz.lastGesture),Jazz.lastGesture=null}},this.clearTimeoutForDigits=function(){Jazz.frameDigitCount>0&&(clearTimeout(Jazz.intervalTimer),Jazz.lastDigitsFound=Jazz.incr=Jazz.timerPercentage=0)},this.setTimeoutForDigits=function(){this.clearTimeoutForDigits(),Jazz.intervalTimer=setInterval(function(){Jazz.incr+=Jazz.WAIT_INTERVAL_TIMER,Jazz.ui.getTimerPercentage()>100&&(clearTimeout(Jazz.intervalTimer),Jazz.handsArray.length>0&&Jazz.lastDigitsFound<Jazz.LAST_VALID_FINGER&&Jazz.event.fingers(a.getCapturedDigits()))},Jazz.WAIT_INTERVAL_TIMER)},this.clearTimeoutForNav=function(){clearTimeout(Jazz.intervalTimer),Jazz.handNavigation=Jazz.incr=Jazz.timerPercentage=0},this.setTimeoutForNav=function(){var a=this;this.clearTimeoutForNav(),Jazz.intervalTimer=setInterval(function(){Jazz.incr+=Jazz.WAIT_INTERVAL_TIMER,Jazz.ui.getTimerPercentage()>100&&(clearTimeout(Jazz.intervalTimer),Jazz.handsArray.length>0&&(Jazz.event.navigation(Jazz.handNavigation),Jazz.lastHand=Jazz.handNavigation,Jazz.repeatNavInterval=setTimeout(function(){Jazz.handNavigation===Jazz.lastHand&&(a.clearTimeoutForNav(),clearTimeout(Jazz.repeatNavInterval))},900)))},Jazz.WAIT_INTERVAL_TIMER)}}function JazzUIHelper(){var a=Jazz.hands;this.drawFingerText=function(){Jazz.frameDigitCount===Jazz.FIRST+1?this.drawText(Jazz.fingersText[Jazz.FIRST],a.getHandPosX(),a.getHandPosY()):Jazz.frameDigitCount===Jazz.SECOND+1?this.drawText(Jazz.fingersText[Jazz.SECOND],a.getHandPosX(),a.getHandPosY()):Jazz.frameDigitCount===Jazz.THIRD+1?this.drawText(Jazz.fingersText[Jazz.THIRD],a.getHandPosX(),a.getHandPosY()):Jazz.frameDigitCount===Jazz.FOURTH+1&&this.drawText(Jazz.fingersText[Jazz.FOURTH],a.getHandPosX(),a.getHandPosY())},this.drawTimerArc=function(b,c){5>c||(radius=2*.01*c*Math.PI,this.evalCtx(function(c){c.beginPath(),c.arc(a.getXForCoords(b),a.getYForCoords(b),30,0,radius),c.lineWidth=10,c.strokeStyle="green",c.stroke()}))},this.getContext=function(){return Jazz.ctx?Jazz.ctx:(Jazz.ctx=Jazz.canvas.getContext("2d"),Jazz.ctx)},this.getBlurredContext=function(){return Jazz.blurredCtx?Jazz.blurredCtx:(Jazz.blurredCtx=Jazz.blurredCanvas.getContext("2d"),Jazz.blurredCtx)},this.getContexts=function(){return[this.getContext(),this.getBlurredContext()]},this.evalCtx=function(a){$.each(this.getContexts(),function(b,c){a(c)})},this.createBaseCanvas=function(a,b){var c=document.createElement("canvas"),d=.9*document.body.clientWidth,e="position:absolute;top:105px;left:-25px;";return 1e3>d&&(d=1050),a&&(e+=this.blurStyle()),c.setAttribute("id",b),c.setAttribute("style",e),c.setAttribute("width",d+"px"),c.setAttribute("height","410px"),c},this.drawCircle=function(b){0===Jazz.timerPercentage&&this.evalCtx(function(c){c.beginPath(),c.arc(a.getXForCoords(b),a.getYForCoords(b),a.getRadiusForFinger(b),0,2*Math.PI),c.fill()})},this.blurStyle=function(){return"-webkit-filter: blur(10px);-moz-filter: blur(10px);-o-filter: blur(10px);-ms-filter: blur(10px)filter: blur(10px);"},this.drawText=function(a,b,c){a&&this.evalCtx(function(d){d.clearRect(0,0,Jazz.canvas.width,Jazz.canvas.height),d.font="bold 22pt Arial",d.fillStyle=Jazz.fillStyle,d.strokeStyle="white",d.fillText(a,b,c-30)})},this.drawHelperArrows=function(){this.evalCtx(function(b){b.drawImage(Jazz.upHelperArrow,a.getHandPosX()-17,-390),b.drawImage(Jazz.rightHelperArrow,-820,a.getHandPosY()-15),b.drawImage(Jazz.leftHelperArrow,-1030,a.getHandPosY()-15),b.drawImage(Jazz.downHelperArrow,a.getHandPosX()-17,-215)})},this.drawUpArrow=function(){this.evalCtx(function(b){b.drawImage(Jazz.upArrow,a.getHandPosX()-17,a.getHandPosY()-15)})},this.drawDownArrow=function(){this.evalCtx(function(b){b.drawImage(Jazz.downArrow,a.getHandPosX()-17,a.getHandPosY()-15)})},this.drawLeftArrow=function(){this.evalCtx(function(b){b.drawImage(Jazz.leftArrow,a.getHandPosX()-17,a.getHandPosY()-15)})},this.drawRightArrow=function(){this.evalCtx(function(b){b.drawImage(Jazz.rightArrow,a.getHandPosX()-14,a.getHandPosY()-15)})},this.drawZoomInIcon=function(){this.evalCtx(function(b){b.drawImage(Jazz.zoomIn,a.getHandPosX()-24,a.getHandPosY()-20)})},this.drawZoomOutIcon=function(){this.evalCtx(function(b){b.drawImage(Jazz.zoomOut,a.getHandPosX()-19,a.getHandPosY()-20)})},this.canDrawHandUp=function(){return a.palm("vertical")>Jazz.config.threshold("up")?(this.drawUpArrow(),!0):!1},this.canDrawHandDown=function(){return a.palm("vertical")<Jazz.config.threshold("down")?(this.drawDownArrow(),!0):!1},this.canDrawHandLeft=function(){return a.palm("horizontal")<Jazz.config.threshold("left")?(this.drawLeftArrow(),!0):!1},this.canDrawHandRight=function(){return a.palm("horizontal")>Jazz.config.threshold("right")?(this.drawRightArrow(),!0):!1},this.canDrawZoomIn=function(){return a.palm("depth")<Jazz.config.threshold("zoomIn")&&Jazz.disableZoom===!1?(this.drawZoomInIcon(),!0):!1},this.canDrawZoomOut=function(){return a.palm("depth")>Jazz.config.threshold("zoomOut")&&Jazz.disableZoom===!1?(this.drawZoomOutIcon(),!0):!1}}function JazzUI(){var a=new JazzUIHelper,b=Jazz.hands;this.createFingerCanvas=function(){Jazz.canvas=this.appendCanvasToDOM(),a.evalCtx(function(a){a.translate(1.2*Jazz.canvas.width,Jazz.canvas.height),a.globalAlpha=Jazz.opacity})},this.show=function(){Jazz.showUI=!0},this.hide=function(){Jazz.showUI=!1},this.clearFingersText=function(){Jazz.fingersText=[],Jazz.disableFingers=!1,Jazz.LAST_VALID_FINGER=1},this.showCanvas=function(){Jazz.showUI===!0&&(document.getElementById("jazz-fingers").style.display="block",document.getElementById("jazz-fingers-shadow").style.display="block")},this.hideCanvas=function(){document.getElementById("jazz-fingers").style.display="none",document.getElementById("jazz-fingers-shadow").style.display="none"},this.updateCanvas=function(){this.clearCanvas();var c=0;for(var d in b.getFingersMap()){var e=++c===Jazz.lastFrame.fingers.length,f=Jazz.timerPercentage>10&&e,g=b.getFinger(d).tipPosition;if(Jazz.simpleMode===!0&&Jazz.handsArray.length>0&&(g=Jazz.handsArray[0].palmPosition),a.drawCircle(g),Jazz.disableHelper===!1&&a.drawHelperArrows(),Jazz.disableTimer===!1&&a.drawTimerArc(g,Jazz.timerPercentage),f&&Jazz.disableFingers===!1&&a.drawFingerText(),Jazz.simpleMode===!0)return}},this.setFingersText=function(a){a?(Jazz.fingersText=a,Jazz.disableFingers=!1,Jazz.LAST_VALID_FINGER=a.length+1):Jazz.clearFingersText()},this.clearCanvas=function(){var b=Jazz.canvas;a.evalCtx(function(a){a.clearRect(1.2*-b.width,-b.height,1.2*b.width,b.height)})},this.appendCanvasToDOM=function(){var b=a.createBaseCanvas(!1,"jazz-fingers"),c=a.createBaseCanvas(!0,"jazz-fingers-shadow");return Jazz.blurredCanvas=c,document.body.appendChild(c),document.body.appendChild(b),b},this.getTimerPercentage=function(){return Jazz.timerPercentage=parseInt(100*(Jazz.incr/Jazz.WAIT_FINGER_MS)),Jazz.timerPercentage},this.getDetectedNav=function(){var b=!1;return a.canDrawHandLeft()?b="left":a.canDrawHandRight()?b="right":a.canDrawHandUp()?b="up":a.canDrawHandDown()?b="down":a.canDrawZoomIn()?b="zoomIn":a.canDrawZoomOut()&&(b="zoomOut"),b}}!function(){var a=this.Jazz={};a.hands=new JazzHands,a.ui=new JazzUI,a.config=new JazzConfig,a.events=new JazzEvents,a.$=this.jQuery,a.VERSION="0.5",a.init=function(b,c){a.config.configureFromOptions(b),a.leapController=new Leap.Controller({enableGestures:!0}),a.ui.createFingerCanvas(),a.leapController.loop(function(b){a.events.loop(b)}),c&&c()},a.show=function(){a.ui.show()},a.hide=function(){a.ui.showUI=!1},a.clearFingersText=function(){a.ui.clearFingersText()},a.setFingersText=function(b){a.ui.setFingersText(b)},a.on=function(b,c){a.event[b]=c}}.call(this);