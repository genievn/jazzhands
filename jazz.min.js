function JazzConfig(){this.configureFromOptions=function(e){Jazz.fillStyle="black",Jazz.LAST_VALID_FINGER=1,this.setupImages(),e&&(e.fillStyle&&(Jazz.arrowColor=Jazz.fillStyle=e.fillStyle),e.waitTimer&&(Jazz.WAIT_FINGER_MS=e.waitTimer),e.fingersText&&(Jazz.fingersText=Jazz.fingersText.concat(e.fingersText),Jazz.LAST_VALID_FINGER=e.fingersText.length+1),Jazz.simpleMode=Jazz.LAST_VALID_FINGER>1?!1:!0,void 0!=e.disableTimer&&e.disableTimer!=Jazz.disableTimer&&(Jazz.disableTimer=e.disableTimer),void 0!=e.disableZoom&&e.disableZoom!=Jazz.disableZoom&&(Jazz.disableZoom=e.disableZoom),void 0!=e.disableHelper&&e.disableHelper!=Jazz.disableHelper&&(Jazz.disableHelper=e.disableHelper),void 0!=e.disableFingers&&e.disableFingers!=Jazz.disableFingers&&(Jazz.disableFingers=e.disableFingers),e.opacity&&(Jazz.opacity=e.opacity))},this.setupImages=function(){var e=$("script[src*=leap]").attr("src");e=e.replace("leap.min.js","");var t=Jazz.filePath=e+"images/";Jazz.upArrow=new Image,Jazz.upArrow.src=t+"gray_up_arrow.png",Jazz.downArrow=new Image,Jazz.downArrow.src=t+"gray_down_arrow.png",Jazz.rightArrow=new Image,Jazz.rightArrow.src=t+"gray_right_arrow.png",Jazz.leftArrow=new Image,Jazz.leftArrow.src=t+"gray_left_arrow.png",Jazz.zoomIn=new Image,Jazz.zoomIn.src=t+"gray_zoom_in.png",Jazz.zoomOut=new Image,Jazz.zoomOut.src=t+"gray_zoom_out.png",this.setupHelperImages()},this.setupHelperImages=function(){var e=$("script[src*=leap]").attr("src");e=e.replace("leap.min.js","");var t=Jazz.filePath=e+"images/";Jazz.upHelperArrow=new Image,Jazz.upHelperArrow.src=t+"gray_up_arrow.png",Jazz.downHelperArrow=new Image,Jazz.downHelperArrow.src=t+"gray_down_arrow.png",Jazz.rightHelperArrow=new Image,Jazz.rightHelperArrow.src=t+"gray_right_arrow.png",Jazz.leftHelperArrow=new Image,Jazz.leftHelperArrow.src=t+"gray_left_arrow.png"},this.threshold=function(e){return"zoomIn"===e?-10:"zoomOut"===e?120:"up"===e?225:"down"===e?90:"left"===e?-80:"right"===e?80:void 0},Jazz.event={finger:function(){},navigation:function(){},gestures:function(){},frames:function(){},progress:function(){},grab:function(){},release:function(){}},Jazz.lastDigitsFound=0,Jazz.handNavigation="",Jazz.WAIT_FINGER_MS=700,Jazz.LAST_VALID_FINGER=2,Jazz.WAIT_INTERVAL_TIMER=40,Jazz.CIRCLE_RADIUS=1.6,Jazz.opacity=.45,Jazz.fingersText=[],Jazz.arrowColor="black",Jazz.incr=0,Jazz.lastFrame={},Jazz.handsArray=[],Jazz.timerPercentage=0,Jazz.simpleMode=!0,Jazz.disableZoom=!1,Jazz.disableHelper=!1,Jazz.disableTimer=!1,Jazz.disableFingers=!1,Jazz.showUI=!0,Jazz.isGrabbing=!1,Jazz.isReady=!1,Jazz.FIRST=0,Jazz.SECOND=1,Jazz.THIRD=2,Jazz.FOURTH=3}function JazzEventHelper(){var e=Jazz.hands,t=Jazz.config,a=200;this.handleNavigation=function(){return e.getCapturedDigits()<Jazz.LAST_VALID_FINGER?!1:(e.hasDetectedHand()===!0&&(e.isNewHandMotion()===!0&&(this.clearTimeoutForNav(),this.setTimeoutForNav()),Jazz.ui.getDetectedNav()===!1&&(this.clearTimeoutForNav(),Jazz.handNavigation=null),Jazz.handNavigation=Jazz.ui.getDetectedNav()),void 0)},this.isHandMovingQuickly=function(){return this.isHandMovingOutQuickly()||this.isHandMovingInQuickly()},this.isHandMovingOutQuickly=function(){if(Jazz.handsArray.length>0){var e=Jazz.handsArray[0].palmVelocity[0],t=Jazz.handsArray[0].palmVelocity[1],n=Jazz.handsArray[0].palmVelocity[2];return-1*a>e||-1*a>t||-1*a>n?!0:!1}return!1},this.isHandMovingInQuickly=function(){if(Jazz.handsArray.length>0){var e=Jazz.handsArray[0].palmVelocity[0],t=Jazz.handsArray[0].palmVelocity[1],n=Jazz.handsArray[0].palmVelocity[2];return e>a||t>a||n>a?!0:!1}return!1},this.handleGrabRelease=function(){return this.isHandMovingOutQuickly()===!1&&0===Jazz.handsArray.length?(Jazz.isGrabbing===!0&&(Jazz.isGrabbing=!1,Jazz.event.release()),void 0):(e.getCapturedDigits()<=1?(this.isHandMovingOutQuickly()===!1&&Jazz.isGrabbing===!1&&Jazz.event.grab(),Jazz.isGrabbing=!0):this.isHandMovingOutQuickly()===!1&&1==Jazz.isGrabbing&&(Jazz.isGrabbing=!1,Jazz.event.release()),void 0)},this.handleProgressNav=function(){if(Jazz.handsArray.length>0){var a=parseInt(100*Jazz.handsArray[0].roll()),n=parseInt(100*Jazz.handsArray[0].pitch())-40,r=parseInt(100*Jazz.handsArray[0].yaw())+10,s=yawRight=pitchUp=pitchDown=rollRight=rollLeft=0;a>0?(rollLeft=a,rollLeft>100&&(rollLeft=100)):0>a&&(rollRight=-1*a,rollRight>100&&(rollRight=100)),n>0?(pitchUp=n,pitchUp>100&&(pitchUp=100)):0>n&&(pitchDown=-1*n,pitchDown>100&&(pitchDown=100)),r>0?(yawRight=r,yawRight>100&&(yawRight=100)):0>r&&(s=-1*r,s>100&&(s=100))}if(this.isHandMovingQuickly()!==!0&&0!==Jazz.handsArray.length){var i=t.threshold("up")-t.threshold("down"),o=(e.palm("vertical")-t.threshold("down"))/i;o>1&&(o=1),0>o&&(o=0);var u=1-o,d=t.threshold("right")-t.threshold("left"),l=(e.palm("horizontal")-t.threshold("left"))/d;l>1&&(l=1),0>l&&(l=0);var h=1-l,c=t.threshold("zoomIn")-t.threshold("zoomOut"),p=(e.palm("depth")-t.threshold("zoomOut"))/c;p>1&&(p=1),0>p&&(p=0);var f=1-p,g={up:parseInt(100*o),down:parseInt(100*u),right:parseInt(100*l),left:parseInt(100*h),zoomIn:parseInt(100*p),zoomOut:parseInt(100*f),pitchUp:pitchUp,pitchDown:pitchDown,rollRight:rollRight,rollLeft:rollLeft,yawRight:yawRight,yawLeft:s};return Jazz.event.progress(g),g}},this.handleFingers=function(){e.isNewFingerCount()&&this.clearTimeoutForDigits(),e.isHoldingValidFinger()&&this.setTimeoutForDigits(),Jazz.lastDigitsFound=e.getCapturedDigits()},this.handleGestureEvents=function(){var t=Jazz.lastFrame.gestures;if(e.getCapturedDigits()>0&&t.length>0)for(var a=0;a<t.length;a++){var n=t[a];Jazz.lastGesture=n}else if(Jazz.lastGesture){var n=Jazz.lastGesture,r=!0;"circle"===n.type&&n.radius<100&&(r=!1),r===!0&&Jazz.event.gestures(Jazz.lastGesture),Jazz.lastGesture=null}},this.clearTimeoutForDigits=function(){Jazz.frameDigitCount>0&&(clearTimeout(Jazz.intervalTimer),Jazz.lastDigitsFound=Jazz.incr=Jazz.timerPercentage=0)},this.setTimeoutForDigits=function(){this.clearTimeoutForDigits(),Jazz.intervalTimer=setInterval(function(){Jazz.incr+=Jazz.WAIT_INTERVAL_TIMER,Jazz.ui.getTimerPercentage()>100&&(clearTimeout(Jazz.intervalTimer),Jazz.handsArray.length>0&&Jazz.lastDigitsFound<Jazz.LAST_VALID_FINGER&&Jazz.event.fingers(e.getCapturedDigits()))},Jazz.WAIT_INTERVAL_TIMER)},this.clearTimeoutForNav=function(){clearTimeout(Jazz.intervalTimer),Jazz.handNavigation=Jazz.incr=Jazz.timerPercentage=0},this.setTimeoutForNav=function(){var e=this;this.clearTimeoutForNav(),Jazz.intervalTimer=setInterval(function(){Jazz.incr+=Jazz.WAIT_INTERVAL_TIMER,Jazz.ui.getTimerPercentage()>100&&(clearTimeout(Jazz.intervalTimer),Jazz.handsArray.length>0&&(Jazz.event.navigation(Jazz.handNavigation),Jazz.lastHand=Jazz.handNavigation,Jazz.repeatNavInterval=setTimeout(function(){Jazz.handNavigation===Jazz.lastHand&&(e.clearTimeoutForNav(),clearTimeout(Jazz.repeatNavInterval))},900)))},Jazz.WAIT_INTERVAL_TIMER)}}function JazzEvents(){var e=Jazz.ui,t=Jazz.hands,a=new JazzEventHelper;this.loop=function(n){Jazz.lastFrame=n,Jazz.handsArray=n.hands,Jazz.handsArray.length>0?e.showCanvas():(e.hideCanvas(),Jazz.handNavigation=null),Jazz.fingers=Jazz.frameDigitCount=n.pointables.length,e.updateCanvas(),Jazz.frameDigitCount>=Jazz.LAST_VALID_FINGER?Jazz.simpleMode=!0:(Jazz.simpleMode=!1,Jazz.disableFingers===!1&&a.handleFingers()),Jazz.isGrabbing===!1&&t.isHoldingValidFinger()===!1&&a.handleNavigation(),a.handleGestureEvents(),a.handleGrabRelease(),a.handleProgressNav(),Jazz.event.frames(Jazz.lastFrame)},this.getFingersMap=function(e){return Jazz.lastFrame.pointablesMap?e?Jazz.lastFrame.pointablesMap[e]:Jazz.lastFrame.pointablesMap:void 0}}function JazzHands(){Jazz.ui,this.getFingersMap=function(e){return Jazz.lastFrame.pointablesMap?e?Jazz.lastFrame.pointablesMap[e]:Jazz.lastFrame.pointablesMap:void 0},this.getFinger=function(e){return this.getFingersMap(e)},this.getRadiusForFinger=function(e){return Math.min(600/Math.abs(e[2]),20)*Jazz.CIRCLE_RADIUS},this.getYForCoords=function(e){return-e[1]-120-this.getRadiusForFinger(e)/2},this.getXForCoords=function(e){return parseInt(e[0]-900-this.getRadiusForFinger(e)/2)},this.getCapturedDigits=function(){return Jazz.frameDigitCount},this.isNewFingerCount=function(){return 0===this.getCapturedDigits()||Jazz.lastDigitsFound!==this.getCapturedDigits()},this.isHoldingFinger=function(){return this.getCapturedDigits()>0&&1==this.isNewFingerCount()},this.isValidFinger=function(){return this.getCapturedDigits()>0&&this.getCapturedDigits()<=Jazz.LAST_VALID_FINGER},this.isHoldingValidFinger=function(){return(this.isHoldingFinger()&&this.isValidFinger())===!0},this.hasDetectedHand=function(){return Jazz.handsArray.length>0},this.isNewHandMotion=function(){return Jazz.handNavigation!==Jazz.ui.getDetectedNav()},this.getFirstFingerPos=function(){for(var e in this.getFingersMap())return this.getFingersMap(e).tipPosition},this.getHandPos=function(e){return Jazz.handsArray.length<=0?void 0:0===e?this.getXForCoords(Jazz.handsArray[0].palmPosition):this.getYForCoords(Jazz.handsArray[0].palmPosition)},this.getHandPosX=function(){return this.getHandPos(0)},this.getHandPosY=function(){return this.getHandPos(1)},this.palm=function(e){if(0!==Jazz.handsArray.length){var t=Jazz.handsArray[0];return"horizontal"===e?t.palmPosition[0]:"vertical"===e?t.palmPosition[1]:"depth"===e?t.palmPosition[2]:void 0}},this.isNewHand=function(){return Jazz.lastHandId==Jazz.handsArray[0].id}}function JazzUI(){var e=new JazzUIHelper,t=Jazz.hands;this.createFingerCanvas=function(){Jazz.canvas=this.appendCanvasToDOM(),e.evalCtx(function(e){e.translate(1.2*Jazz.canvas.width,Jazz.canvas.height),e.globalAlpha=Jazz.opacity})},this.show=function(){Jazz.showUI=!0},this.hide=function(){Jazz.showUI=!1},this.clearFingersText=function(){Jazz.fingersText=[],Jazz.disableFingers=!1,Jazz.LAST_VALID_FINGER=1},this.showCanvas=function(){Jazz.showUI===!0&&(document.getElementById("jazz-fingers").style.display="block",document.getElementById("jazz-fingers-shadow").style.display="block")},this.hideCanvas=function(){document.getElementById("jazz-fingers").style.display="none",document.getElementById("jazz-fingers-shadow").style.display="none"},this.updateCanvas=function(){this.clearCanvas();var a=0;for(var n in t.getFingersMap()){var r=++a===Jazz.lastFrame.fingers.length,s=Jazz.timerPercentage>10&&r,i=t.getFinger(n).tipPosition;if(Jazz.simpleMode===!0&&Jazz.handsArray.length>0&&(i=Jazz.handsArray[0].palmPosition),e.drawCircle(i),Jazz.disableHelper===!1&&e.drawHelperArrows(),Jazz.disableTimer===!1&&e.drawTimerArc(i,Jazz.timerPercentage),s&&Jazz.disableFingers===!1&&e.drawFingerText(),Jazz.simpleMode===!0)return}},this.setFingersText=function(e){e?(Jazz.fingersText=e,Jazz.disableFingers=!1,Jazz.LAST_VALID_FINGER=e.length+1):Jazz.clearFingersText()},this.clearCanvas=function(){var t=Jazz.canvas;e.evalCtx(function(e){e.clearRect(1.2*-t.width,-t.height,1.2*t.width,t.height)})},this.appendCanvasToDOM=function(){var t=e.createBaseCanvas(!1,"jazz-fingers"),a=e.createBaseCanvas(!0,"jazz-fingers-shadow");return Jazz.blurredCanvas=a,document.body.appendChild(a),document.body.appendChild(t),t},this.getTimerPercentage=function(){return Jazz.timerPercentage=parseInt(100*(Jazz.incr/Jazz.WAIT_FINGER_MS)),Jazz.timerPercentage},this.getDetectedNav=function(){var t=!1;return e.canDrawHandLeft()?t="left":e.canDrawHandRight()?t="right":e.canDrawHandUp()?t="up":e.canDrawHandDown()?t="down":e.canDrawZoomIn()?t="zoomIn":e.canDrawZoomOut()&&(t="zoomOut"),t}}function JazzUIHelper(){var e=Jazz.hands;this.drawFingerText=function(){Jazz.frameDigitCount===Jazz.FIRST+1?this.drawText(Jazz.fingersText[Jazz.FIRST],e.getHandPosX(),e.getHandPosY()):Jazz.frameDigitCount===Jazz.SECOND+1?this.drawText(Jazz.fingersText[Jazz.SECOND],e.getHandPosX(),e.getHandPosY()):Jazz.frameDigitCount===Jazz.THIRD+1?this.drawText(Jazz.fingersText[Jazz.THIRD],e.getHandPosX(),e.getHandPosY()):Jazz.frameDigitCount===Jazz.FOURTH+1&&this.drawText(Jazz.fingersText[Jazz.FOURTH],e.getHandPosX(),e.getHandPosY())},this.drawTimerArc=function(t,a){5>a||(radius=2*.01*a*Math.PI,this.evalCtx(function(a){a.beginPath(),a.arc(e.getXForCoords(t),e.getYForCoords(t),30,0,radius),a.lineWidth=10,a.strokeStyle="green",a.stroke()}))},this.getContext=function(){return Jazz.ctx?Jazz.ctx:(Jazz.ctx=Jazz.canvas.getContext("2d"),Jazz.ctx)},this.getBlurredContext=function(){return Jazz.blurredCtx?Jazz.blurredCtx:(Jazz.blurredCtx=Jazz.blurredCanvas.getContext("2d"),Jazz.blurredCtx)},this.getContexts=function(){return[this.getContext(),this.getBlurredContext()]},this.evalCtx=function(e){$.each(this.getContexts(),function(t,a){e(a)})},this.createBaseCanvas=function(e,t){var a=document.createElement("canvas"),n=.9*document.body.clientWidth,r="position:absolute;top:105px;left:-25px;";return 1e3>n&&(n=1050),e&&(r+=this.blurStyle()),a.setAttribute("id",t),a.setAttribute("style",r),a.setAttribute("width",n+"px"),a.setAttribute("height","410px"),a},this.drawCircle=function(t){0===Jazz.timerPercentage&&this.evalCtx(function(a){a.beginPath(),a.arc(e.getXForCoords(t),e.getYForCoords(t),e.getRadiusForFinger(t),0,2*Math.PI),a.fill()})},this.blurStyle=function(){return"-webkit-filter: blur(10px);-moz-filter: blur(10px);-o-filter: blur(10px);-ms-filter: blur(10px)filter: blur(10px);"},this.drawText=function(e,t,a){e&&this.evalCtx(function(n){n.clearRect(0,0,Jazz.canvas.width,Jazz.canvas.height),n.font="bold 22pt Arial",n.fillStyle=Jazz.fillStyle,n.strokeStyle="white",n.fillText(e,t,a-30)})},this.drawHelperArrows=function(){this.evalCtx(function(t){t.drawImage(Jazz.upHelperArrow,e.getHandPosX()-17,-390),t.drawImage(Jazz.rightHelperArrow,-820,e.getHandPosY()-15),t.drawImage(Jazz.leftHelperArrow,-1030,e.getHandPosY()-15),t.drawImage(Jazz.downHelperArrow,e.getHandPosX()-17,-215)})},this.drawUpArrow=function(){this.evalCtx(function(t){t.drawImage(Jazz.upArrow,e.getHandPosX()-17,e.getHandPosY()-15)})},this.drawDownArrow=function(){this.evalCtx(function(t){t.drawImage(Jazz.downArrow,e.getHandPosX()-17,e.getHandPosY()-15)})},this.drawLeftArrow=function(){this.evalCtx(function(t){t.drawImage(Jazz.leftArrow,e.getHandPosX()-17,e.getHandPosY()-15)})},this.drawRightArrow=function(){this.evalCtx(function(t){t.drawImage(Jazz.rightArrow,e.getHandPosX()-14,e.getHandPosY()-15)})},this.drawZoomInIcon=function(){this.evalCtx(function(t){t.drawImage(Jazz.zoomIn,e.getHandPosX()-24,e.getHandPosY()-20)})},this.drawZoomOutIcon=function(){this.evalCtx(function(t){t.drawImage(Jazz.zoomOut,e.getHandPosX()-19,e.getHandPosY()-20)})},this.canDrawHandUp=function(){return e.palm("vertical")>Jazz.config.threshold("up")?(this.drawUpArrow(),!0):!1},this.canDrawHandDown=function(){return e.palm("vertical")<Jazz.config.threshold("down")?(this.drawDownArrow(),!0):!1},this.canDrawHandLeft=function(){return e.palm("horizontal")<Jazz.config.threshold("left")?(this.drawLeftArrow(),!0):!1},this.canDrawHandRight=function(){return e.palm("horizontal")>Jazz.config.threshold("right")?(this.drawRightArrow(),!0):!1},this.canDrawZoomIn=function(){return e.palm("depth")<Jazz.config.threshold("zoomIn")&&Jazz.disableZoom===!1?(this.drawZoomInIcon(),!0):!1},this.canDrawZoomOut=function(){return e.palm("depth")>Jazz.config.threshold("zoomOut")&&Jazz.disableZoom===!1?(this.drawZoomOutIcon(),!0):!1}}!function(){var e=this.Jazz={};e.hands=new JazzHands,e.ui=new JazzUI,e.config=new JazzConfig,e.events=new JazzEvents,e.$=this.jQuery,e.VERSION="0.5",e.init=function(t,a){e.config.configureFromOptions(t),e.leapController=new Leap.Controller({enableGestures:!0}),e.ui.createFingerCanvas(),e.leapController.loop(function(t){e.events.loop(t)}),a&&a()},e.show=function(){e.ui.show()},e.hide=function(){e.ui.showUI=!1},e.clearFingersText=function(){e.ui.clearFingersText()},e.setFingersText=function(t){e.ui.setFingersText(t)},e.on=function(t,a){e.event[t]=a}}.call(this);